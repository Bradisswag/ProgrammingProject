<!doctype html>
<html>

<head>
    <title>Programming Project | Jet-pack Dodger</title>
</head>

<body>
    <canvas id="gameCanvas" width="500" height="900"></canvas>
    <script>
        var canvas, canvasContext, imgAssests;

        window.onload = function() {
            canvas = document.getElementById('gameCanvas')
            canvasContext = canvas.getContext('2d');
            imgAssests = LoadImageAssests();
            document.addEventListener('keydown', keyPressed);
            document.addEventListener('keyup', keyReleased);

            for (i = 0; i <= brickCount; i++) {
                brickArray.push(randomBrick());
            }
            for (i = 0; i <= fuelCount; i++) {
                fuelArray.push(randomFuel());
            }

            setInterval(mainLoop, 2500 / 50);
        }

        // Player
        var PlayerXPos = 250;
        var PlayerYPos = 850;
        var PlayerWidth = 20;
        var PlayerHeight = 20;

        //System
        var GameRun = false;
        var Easy = false;
        var Medium = false;
        var Hard = false;

        //StartScreen
        var oneKeyPressed = false;
        var twoKeyPressed = false;
        var threeKeyPressed = false;

        //Random Objects
        var brickXpos = 0;
        var brickYpos = 0;
        var brickYspeed = 1;
        var brickXspeed = 1;
        var brickWidth = 10;
        var brickHeight = 10;

        var brickArray = [];
        var brickCount = 0;

        //Fuel Cans
        var fuelXpos = 0;
        var fuelYpos = 0;
        var fuelYspeed = 1;
        var fuelXspeed = 1;
        var fuelWidth = 50;
        var fuelHeight = 50;

        var fuelArray = [];
        var fuelCount = 0;

        var diffculty = 0;
        
        function mainLoop() {
            if (GameRun == true) {

                colorRect(0, 0, canvas.width, canvas.height, 'black') // canvas
                colorRect(PlayerXPos, PlayerYPos, PlayerWidth, PlayerHeight, 'orange'); // Player object

                drawSprite(imgs.background, 0, 0, canvas.width, canvas.height) // canvas background

                drawSprite(imgs.player, PlayerXPos, PlayerYPos, 50, 50); // Player jetpack

                drawSprite(imgs.doughnut, canvas.width / 2, 50, 50, 50); // Player jetpack

                brickRender();
                brickMovement();
                fuelRender()
                fuelMovement()

            } else if (GameRun == false) {
                drawSprite(imgs.startscreen, 0, 0, canvas.width, canvas.height) // canvas background
                prompt('how hard?,123');
                if (diffculty == 1) {
                    brickCount = 5;
                    fuelCount = 3;
                    GameRun == true
                }
                if (diffculty == 2) {
                    brickCount = 10;
                    fuelCount = 4;
                    GameRun == true
                }
                if (diffculty == 3) {
                    brickCount = 15;
                    fuelCount = 5;
                    GameRun == true
                }
            }
        }

        function brickRender() {
            brickArray.forEach(function(brick, index) {
                colorRect(brick.brickXpos, brick.brickYpos, brick.brickWidth, brick.brickHeight, 'silver');
            });
        }

        function fuelRender() {
            fuelArray.forEach(function(fuel, index) {
                drawSprite(imgs.fuelcan, fuel.fuelXpos, fuel.fuelYpos, fuel.fuelWidth, fuel.fuelHeight); // fuel can
            });
        }

        function randomFuel() {
            brickWidth = Math.floor(Math.random() * (25 - 50) + 1);
            brickHeight = Math.floor(Math.random() * (25 - 50) + 1);

            var randFuel = {
                fuelWidth: fuelWidth,
                fuelHeight: fuelHeight,
                fuelXpos: Math.floor(Math.random() * ((canvas.width - fuelWidth))),
                fuelYpos: Math.floor(Math.random() * ((800 - fuelHeight))),
                fuelXspeed: Math.floor(Math.random() * (25 - 1) + 1),
                fuelYspeed: Math.floor(Math.random() * (25 - 1) + 1)
            }
            return randFuel;
        }

        function randomBrick() {
            brickWidth = Math.floor(Math.random() * (25 - 50) + 1);
            brickHeight = Math.floor(Math.random() * (25 - 50) + 1);

            var randBrick = {
                brickWidth: brickWidth,
                brickHeight: brickHeight,
                brickXpos: Math.floor(Math.random() * ((canvas.width - brickWidth))),
                brickYpos: 0, //Math.floor(Math.random() * ((700 - brickHeight))),
                brickXspeed: Math.floor(Math.random() * (25 - 1) + 1),
                brickYspeed: Math.floor(Math.random() * (25 - 1) + 1)
            }
            return randBrick;
        }

        function brickMovement() {
            brickArray.forEach(function(bricks, index) {

                bricks.brickXpos += bricks.brickXspeed
                bricks.brickYpos += bricks.brickYspeed

                if (bricks.brickXpos > canvas.width - bricks.brickWidth) {
                    bricks.brickXspeed *= -1;
                }
                if (bricks.brickXpos < 0) {
                    bricks.brickXspeed *= -1;
                }
                if (bricks.brickYpos > canvas.height - bricks.brickHeight) {
                    bricks.brickYpos = 0 - bricks.brickHeight;
                }
            });
        }

        function fuelMovement() {
            fuelArray.forEach(function(fuel, index) {

                fuel.fuelXpos += fuel.fuelXspeed
                fuel.fuelYpos += fuel.fuelYspeed

                if (fuel.fuelXpos > canvas.width - fuel.fuelWidth) {
                    fuel.fuelXspeed *= -1;
                }
                if (fuel.fuelXpos < 0) {
                    fuel.fuelXspeed *= -1;
                }
                if (fuel.fuelYpos > canvas.height - fuel.fuelHeight) {
                    fuel.fuelYpos = 0 - fuel.fuelHeight;
                }
            });
        }
        //                if (bricks.brickYpos < 0) {
        //                    bricks.brickYspeed *= -1;
        //                }

        function keyPressed(evt) {
            if (evt.keyCode == 49) { //1
                oneKeyPressed = true;
            }
            if (evt.keyCode == 50) { //2
                twoKeyPressed = true;
            }
            if (evt.keyCode == 51) { //3
                threeKeyPressed = true;
            }
            if (evt.keyCode == 37) { //< Left key
                leftArrowKeyPressed = true;
            }
            if (evt.keyCode == 39) { //> Right key
                rightArrowKeyPressed = true;
            }
            if (evt.keyCode == 38) { //^ Up key
                upArrowKeyPressed = true;
            }
            if (evt.keyCode == 40) { //v Down key
                downArrowKeyPressed = true;
            }
        }

        function keyReleased(evt) {
            if (evt.keyCode == 49) { //1
                oneKeyPressed = false;
            }
            if (evt.keyCode == 50) { //2
                twoKeyPressed = false;
            }
            if (evt.keyCode == 51) { //3
                threeKeyPressed = false;
            }
            if (evt.keyCode == 37) { //< Left key
                leftArrowKeyPressed = false;
            }
            if (evt.keyCode == 39) { //> Right key
                rightArrowKeyPressed = false;
            }
            if (evt.keyCode == 38) { //^ Up key
                upArrowKeyPressed = false;
            }
            if (evt.keyCode == 40) { //v Down key
                downArrowKeyPressed = false;
            }
        }

        function LoadImageAssests() {
            imgs = {};
            imgs.player = new Image();
            imgs.player.src = 'jetpack.png';

            imgs.background = new Image();
            imgs.background.src = 'space.jpg';

            imgs.doughnut = new Image();
            imgs.doughnut.src = 'Doughnut.png';

            imgs.startscreen = new Image();
            imgs.startscreen.src = 'startscreen0.png';

            imgs.fuelcan = new Image();
            imgs.fuelcan.src = 'fuelcan.png';

            return imgs;
        }

        function drawSprite(src, x, y, w, h) {
            canvasContext.drawImage(src, x, y, w, h);
        }

        function colorRect(x, y, w, h, c) {
            canvasContext.fillStyle = c;
            canvasContext.fillRect(x, y, w, h);
        }

        function drawText(x, y, color, msg, sizeStyle) {
            canvasContext.fillStyle = color;
            canvasContext.fillText(msg, x, y);
            canvasContext.font = sizeStyle;
        }

    </script>
</body>

</html>
