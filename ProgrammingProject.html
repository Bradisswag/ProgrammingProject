<!doctype html>
<html>

<head>
    <title>Programming Project | Jet-pack Dodger</title>
</head>

<body>
    <canvas id="gameCanvas" width="500" height="900"></canvas>
    <script>
        var canvas, canvasContext, imgAssests;

        window.onload = function() {
            canvas = document.getElementById('gameCanvas')
            canvasContext = canvas.getContext('2d');
            imgAssests = LoadImageAssests();
            document.addEventListener('keydown', keyPressed);
            document.addEventListener('keyup', keyReleased);

            for (i = 0; i <= brickCount; i++) {
                brickArray.push(randomBrick());
            }

            setInterval(mainLoop, 2500 / 50);
        }

        // Player
        var PlayerXPos = 250;
        var PlayerYPos = 850;
        var PlayerWidth = 20;
        var PlayerHeight = 20;

        //System
        var GameRun = false;
        var Easy = false;
        var Medium = false;
        var Hard = false;

        //StartScreen
        var oneKeyPressed = false;
        var twoKeyPressed = false;
        var threeKeyPressed = false;

        //RandomObject
        var brickXpos = 0;
        var brickYpos = 0;
        var brickYspeed = 1;
        var brickXspeed = 1;
        var brickWidth = 10;
        var brickHeight = 10;

        var brickArray = [];
        var brickCount = 10;

        function brickRender() {
            brickArray.forEach(function(brick, index) {
                colorRect(brick.brickXpos, brick.brickYpos, brick.brickWidth, brick.brickHeight, 'silver');
            });
        }

        function mainLoop() {
            if (GameRun == true) {
                if (Easy == true) {
                    colorRect(0, 0, canvas.width, canvas.height, 'black') // canvas
                    colorRect(PlayerXPos, PlayerYPos, PlayerWidth, PlayerHeight, 'orange'); // Player object

                    drawSprite(imgs.background, 0, 0, canvas.width, canvas.height) // canvas background

                    drawSprite(imgs.player, PlayerXPos, PlayerYPos, 50, 50); // Player jetpack

                    drawSprite(imgs.doughnut, canvas.width / 2, 50, 50, 50); // Player jetpack

                    brickRender();
                    brickMovement();
                }
                if (Medium == true) {
                    colorRect(0, 0, canvas.width, canvas.height, 'black') // canvas
                    colorRect(PlayerXPos, PlayerYPos, PlayerWidth, PlayerHeight, 'orange'); // Player object

                    drawSprite(imgs.background, 0, 0, canvas.width, canvas.height) // canvas background

                    drawSprite(imgs.player, PlayerXPos, PlayerYPos, 50, 50); // Player jetpack

                    drawSprite(imgs.doughnut, canvas.width / 2, 50, 50, 50); // Player jetpack

                    brickRender();
                    brickMovement();
                }
                if (Hard == true) {
                    colorRect(0, 0, canvas.width, canvas.height, 'black') // canvas
                    colorRect(PlayerXPos, PlayerYPos, PlayerWidth, PlayerHeight, 'orange'); // Player object

                    drawSprite(imgs.background, 0, 0, canvas.width, canvas.height) // canvas background

                    drawSprite(imgs.player, PlayerXPos, PlayerYPos, 50, 50); // Player jetpack

                    drawSprite(imgs.doughnut, canvas.width / 2, 50, 50, 50); // Player jetpack

                    brickRender();
                    brickMovement();
                }
            } else if (GameRun == false) {
                drawSprite(imgs.startscreen, 0, 0, canvas.width, canvas.height) // canvas background
                if (oneKeyPressed) {
                    Easy = true;
                    GameRun = true;
                }
                if (twoKeyPressed) {
                    Medium = true;
                    GameRun = true;
                }
                if (threeKeyPressed) {
                    Hard = true;
                    GameRun = true;
                }
            }
        }

        function randomBrick() {
            brickWidth = Math.floor(Math.random() * (25 - 50) + 1);
            brickHeight = Math.floor(Math.random() * (25 - 50) + 1);

            var randBrick = {
                brickWidth: brickWidth,
                brickHeight: brickHeight,
                brickXpos: Math.floor(Math.random() * ((canvas.width - brickWidth))),
                brickYpos: Math.floor(Math.random() * ((700 - brickHeight))),
                brickXspeed: Math.floor(Math.random() * (25 - 1) + 1),
                brickYspeed: Math.floor(Math.random() * (25 - 1) + 1)
            }
            return randBrick;
        }

        function brickMovement() {

            brickArray.forEach(function(bricks, index) {

                bricks.brickXpos += bricks.brickXspeed
                bricks.brickYpos += bricks.brickYspeed

                if (bricks.brickXpos > canvas.width - bricks.brickWidth) {
                    bricks.brickXspeed *= -1;
                }
                if (bricks.brickXpos < 0) {
                    bricks.brickXspeed *= -1;
                }
                if (bricks.brickYpos > canvas.width - bricks.brickWidth) {
                    bricks.brickYspeed *= -1;
                }
                if (bricks.brickYpos < 0) {
                    bricks.brickYspeed *= -1;
                }
            });

        }
        
        function keyPressed(evt) {
            if (evt.keyCode == 49) {
                oneKeyPressed = true;
            }
            if (evt.keyCode == 50) {
                twoKeyPressed = true;
            }
            if (evt.keyCode == 51) {
                threeKeyPressed = true;
            }
        }

        function keyReleased(evt) {
            if (evt.keyCode == 49) {
                oneKeyPressed = false;
            }
            if (evt.keyCode == 50) {
                twoKeyPressed = false;
            }
            if (evt.keyCode == 51) {
                threeKeyPressed = false;
            }
        }

        function LoadImageAssests() {
            imgs = {};
            imgs.player = new Image();
            imgs.player.src = 'jetpack.png';

            imgs.background = new Image();
            imgs.background.src = 'space.jpg';

            imgs.doughnut = new Image();
            imgs.doughnut.src = 'Doughnut.png';

            imgs.startscreen = new Image();
            imgs.startscreen.src = 'startscreen0.png';

            return imgs;
        }

        function drawSprite(src, x, y, w, h) {
            canvasContext.drawImage(src, x, y, w, h);
        }

        function colorRect(x, y, w, h, c) {
            canvasContext.fillStyle = c;
            canvasContext.fillRect(x, y, w, h);
        }

        function drawText(x, y, color, msg, sizeStyle) {
            canvasContext.fillStyle = color;
            canvasContext.fillText(msg, x, y);
            canvasContext.font = sizeStyle;
        }

        function jetPack() {

        }
    </script>
</body>

</html>
